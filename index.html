<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>FinzoTalk</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDKWlkEcCskaGVMU4BZbE1LMR6HlhkCnz8",
  authDomain: "stock-portfolio-web-final.firebaseapp.com",
  projectId: "stock-portfolio-web-final",
  storageBucket: "stock-portfolio-web-final.firebasestorage.app",
  messagingSenderId: "804419033716",
  appId: "1:804419033716:web:ad50c042cc663acb528f21"
};
firebase.initializeApp(firebaseConfig);
</script>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,system-ui;background:#f5f7fa;color:#1e293b}

/* LOGIN */
#loginBox{max-width:420px;margin:100px auto;background:#fff;padding:28px;border-radius:14px;
box-shadow:0 15px 40px rgba(0,0,0,.12);text-align:center}
#loginBox h2{color:#6d28d9}
#loginBox input{width:100%;padding:12px;margin:8px 0;border-radius:8px;border:1px solid #cbd5e1}
#loginBox button{width:100%;padding:12px;border:none;border-radius:8px;margin-top:10px;cursor:pointer}
.login{background:#6d28d9;color:#fff}
.google{background:#f1f5f9}
.error{color:#ef4444;font-size:14px;margin-top:6px}

/* TOP BAR */
.top{display:flex;align-items:center;gap:16px;padding:12px 20px;background:#6d28d9;color:#fff}
.logo{font-size:22px;font-weight:700}
.tabs button{background:none;border:none;color:#fff;padding:6px 10px;border-radius:6px;cursor:pointer}
.tabs button.active{background:rgba(255,255,255,.25)}
.search{flex:1}
.search input{width:100%;padding:8px 12px;border-radius:6px;border:none}

/* SETTINGS */
.settings{position:relative;cursor:pointer}
.menu{display:none;position:absolute;right:0;top:36px;background:#fff;color:#1e293b;
width:220px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.15)}
.menu div{padding:12px;border-bottom:1px solid #e5e7eb}
.menu input{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #cbd5e1}
.menu button{width:100%;padding:10px;border:none;border-radius:6px;cursor:pointer}
.saveName{background:#6d28d9;color:#fff}
.logout{background:#ef4444;color:#fff}

/* CONTENT */
#app{display:none}
main{padding:20px}
.section{display:none}
.section.active{display:block}

/* STOCKS */
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:16px}
.card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.08)}
.card button{margin-top:10px;padding:6px 10px;background:#6d28d9;color:#fff;border:none;border-radius:6px}

/* HOLDINGS */
table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden}
th,td{padding:12px;border-bottom:1px solid #e5e7eb;text-align:center}
.del{background:#ef4444;color:#fff;border:none;padding:6px 10px;border-radius:6px}

/* MODAL */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center}
.modalBox{background:#fff;width:90%;max-width:420px;padding:24px;border-radius:14px}
.modalBox input{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #d1d5db}
.modalBtns{display:flex;gap:10px}
.modalBtns button{flex:1;padding:10px;border:none;border-radius:8px}
.save{background:#6d28d9;color:#fff}
.cancel{background:#e5e7eb}

@media(max-width:768px){.top{flex-wrap:wrap}}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
<h2>FinzoTalk Login</h2>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button class="login" onclick="loginEmail()">Login / Signup</button>
<button class="google" onclick="loginGoogle()">Continue with Google</button>
<div class="error" id="loginError"></div>
</div>

<!-- APP -->
<div id="app">
<div class="top">
<div class="logo">FinzoTalk</div>
<div class="tabs">
<button class="active" onclick="tab('stocks',this)">Stocks</button>
<button onclick="tab('holdings',this)">Holdings</button>
<button onclick="tab('mf',this)">Mutual Funds</button>
</div>
<div class="search">
<input id="search" placeholder="Search NIFTY / SENSEX stocks" onkeyup="searchStocks()">
</div>
<div class="settings" onclick="toggleMenu()">‚öôÔ∏è
<div class="menu" id="menu">
<div>Email: <span id="userEmail"></span></div>
<div>
Edit name
<input id="nameInput">
<button class="saveName" onclick="saveName()">Save</button>
</div>
<div><button class="logout" onclick="logout()">Logout</button></div>
</div>
</div>
</div>

<main>
<div id="stocks" class="section active">
<h3>Top Stocks</h3>
<div class="cards" id="stockCards"></div>
</div>

<div id="holdings" class="section">
<h3>Your Holdings</h3>
<table id="holdingsTable"></table>
</div>

<div id="mf" class="section">
<h3>Mutual Funds</h3>
<p>Coming soon üöÄ</p>
</div>
</main>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modalBox">
<h3>Add Stock</h3>
<input id="mStock" disabled>
<input id="mPrice" placeholder="Buy Price">
<input id="mQty" placeholder="Quantity">
<div class="modalBtns">
<button class="save" onclick="saveStock()">Save</button>
<button class="cancel" onclick="closeModal()">Cancel</button>
</div>
</div>
</div>

<script>
const auth=firebase.auth();

/* FULL NIFTY + SENSEX */
const STOCKS=[
"RELIANCE","TCS","INFOSYS","HDFC BANK","ICICI BANK","SBIN","ITC","LT","AXIS BANK",
"KOTAK BANK","HUL","ASIAN PAINTS","BAJAJ FINANCE","BHARTI AIRTEL","MARUTI",
"TATA MOTORS","TATA STEEL","SUN PHARMA","NTPC","POWER GRID","ONGC","COAL INDIA",
"GRASIM","ULTRATECH","TECH MAHINDRA","HCL TECH","ADANI PORTS","ADANI ENT"
];

let holdings=JSON.parse(localStorage.getItem("holdings"))||[];
let currentStock="";

/* LOGIN */
function loginEmail(){
loginError.innerText="";
if(!email.value){loginError.innerText="Enter email";return}
if(!password.value){loginError.innerText="Enter password";return}

auth.signInWithEmailAndPassword(email.value,password.value)
.catch(e=>{
if(e.code==="auth/user-not-found"){
auth.createUserWithEmailAndPassword(email.value,password.value)
.catch(err=>loginError.innerText=err.message)
}else loginError.innerText=e.message
});
}
function loginGoogle(){
auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
}

auth.onAuthStateChanged(u=>{
if(u){
loginBox.style.display="none";
app.style.display="block";
userEmail.innerText=u.email;
nameInput.value=u.displayName||"";
renderStocks(STOCKS.slice(0,4));   // ONLY TOP 4 ON HOME
renderHoldings();
}
});

/* SETTINGS */
function toggleMenu(){menu.style.display=menu.style.display==="block"?"none":"block"}
function saveName(){
auth.currentUser.updateProfile({displayName:nameInput.value});
}

/* TABS */
function tab(id,el){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
el.classList.add("active");
}

/* STOCKS */
function renderStocks(list){
stockCards.innerHTML="";
list.forEach(s=>{
let d=document.createElement("div");
d.className="card";
d.innerHTML=`<b>${s}</b><br><button onclick="openModal('${s}')">Add</button>`;
stockCards.appendChild(d);
});
}
function searchStocks(){
let q=search.value.toUpperCase();
renderStocks(STOCKS.filter(s=>s.includes(q)));
}

/* MODAL */
function openModal(s){
currentStock=s;
mStock.value=s;
modal.style.display="flex";
}
function closeModal(){
modal.style.display="none";
mPrice.value="";mQty.value="";
}
function saveStock(){
holdings.push({name:currentStock,price:+mPrice.value,qty:+mQty.value});
localStorage.setItem("holdings",JSON.stringify(holdings));
closeModal();
renderHoldings();
tab("holdings",document.querySelectorAll(".tabs button")[1]);
}

/* HOLDINGS */
function renderHoldings(){
holdingsTable.innerHTML="<tr><th>Stock</th><th>Price</th><th>Qty</th><th>Total</th><th></th></tr>";
holdings.forEach((h,i)=>{
holdingsTable.innerHTML+=`
<tr>
<td>${h.name}</td><td>${h.price}</td><td>${h.qty}</td>
<td>${h.price*h.qty}</td>
<td><button class="del" onclick="del(${i})">Delete</button></td>
</tr>`;
});
}
function del(i){
holdings.splice(i,1);
localStorage.setItem("holdings",JSON.stringify(holdings));
renderHoldings();
}

/* LOGOUT */
function logout(){auth.signOut();location.reload();}
</script>

</body>
</html>
